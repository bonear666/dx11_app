# dx11_app
Технологии: C++, WinAPI, DirectX.

Небольшое приложение с 3d-графикой.
Задумывалось как игра, где игрок находится на ограниченной в виде квадрата области, из которой нельзя выйти за границы, и где нужно уклонятся от движущихся в направлении камеры предметов.
Столкновение с некоторыми предметами приводило бы к завершению игры, столкновение с другими - только отталкивало бы камеру.
На данный момент не хватает добавления скрипта, который бы завершал игру при столкновении с определенными объектами, и не хватает исправления некоторых багов, о них будет сказано ниже. 
Ну и дальше можно добавлять еще всяких новшеств: таймеры, многопоточность, попиксельное освещение.

![image4](https://github.com/bonear666/dx11_app/blob/main/screenshots/image4.JPG)
![image5](https://github.com/bonear666/dx11_app/blob/main/screenshots/image5.JPG)
![image3](https://github.com/bonear666/dx11_app/blob/main/screenshots/image3.JPG)

# ВАЖНО!
exe-файл находится в Debug.

В приложении нет таймеров, поэтому камера и все объекты двигаются в зависимости от производительности компьютера.  
Если объекты двигаются слишком быстро/медленно - нужно менять значение #define DYNAMIC_HIT_BOX_MOVEVECTOR_LENGTH в preproc.h  
Если камера двигается слишком быстро/медленно - нужно менять значение #define CAMERA_MOVEVECTOR_LENGTH в preproc.h
Если объекты крутятся слишком быстро/медленно - нужно менять значение #define ROTATION_ANGLE в preproc.h

Закрывать приложение приходится через диспетчер задач.(работаю над этим)

**Для корректной работы:**
При первом запуске приложения в файле log.txt первый флаг(первый, после BOM-символа),он же wchar символ, должен быть NULL(0x0000).
Это нужно, чтобы скомпилировались шейдеры, не факт, что те, скомпилированные шейдеры, которые уже есть в репозитории будут правильно работать на другом компьютере.  
При компиляции исполняемый файл должен компилироваться в ту же директорию, где находятся каталоги res, src, shaders, и #define _DEBUG в preproc.h должен быть закомментирован.  
Либо исполняемый файл должен компилироваться в ту же директорию, где находятся каталоги res, src, shaders, но в каталог Debug в этой директории, и должен быть объявлен #define _DEBUG в preproc.h.  

# Описание файлов, каталогов
**Каталог res:**  
* Каталог compiled_shaders - в нем хранятся скомпилированные шейдеры  
* compiled_shaders_list.txt - список скомпилированных шейдеров  
* shaders_list.txt - список шейдеров, которые нужно скомпилировать  
* log.txt - файл для фиксирования каких-то событий  

**Каталог shaders:**  
* triangle_VS.hlsl - вершинный шейдер пирамиды  
* triangle_PS.hlsl - пиксельный шейдер пирамиды 
* walls_VS.hlsl - вершинный шейдер стен  
	
**Каталог src:**  
* directx_func.cpp - функции объектов directx 
* hitbox_func.cpp -  функции хитбоксов
* math_func.cpp -  математические функции(матрицы, векторы)
* shaderfiles_func.cpp - работа с файлами шейдеров 
* wnd_func.cpp -  оконные функции
* main.cpp -  главная функция
* global.h - глобальные переменные 
* global_extern.h - ссылки на глобальные переменные для cpp/h-файлов
* preproc.h -  директивы препроцессора
* preproc_func.h -  директивы препроцессора
* struct.h -  определения структур

# Структуры файлов из каталога res
**Структура res\shaders_list.txt(LE, utf-16):**  
	BOM-байты,  
	Информация о шейдерах.  
	Стек информации о шейдере, состоит из:  
		1) Двух байт, в которых хранится число символов в названии шейдера.  
		2) Сама строка(C-строка), начинающаяся с "\\", заканчивающаяся на "_*shaderType*S.hlsl\0".  

**Структура res\compiled_shaders_list.txt(LE, utf-16)** аналогична.  
Только строка с названием заканчивается на ".cso\0".  

**Структура res\log.txt(LE, utf-16):**  
	BOM-байты,  
	Флаг(2 байта), который фиксирует были ли уже скомпилированы шейдеры. 0x0000 - нет, 0x0001 - да.  

# Проблемы
* Неправильно работающие столкновения с неподвижными объектами, они реализованы, но их нужно отлаживать.
* При большом количестве поворотов мышью, камера начинает крениться. С точки зрения математики - реализация поворотов камеры верная(вроде), но видимо точные значения новой оси Y, вокруг которой происходит поворот, не помещаются полностью в вектор, из-за этого происходит вращение вокруг искривленной оси Y.(работаю над этим)
* Закрывать приложение приходится через диспетчер задач.(работаю над этим)

